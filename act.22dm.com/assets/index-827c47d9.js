import{_ as s,d as a,o as i,c as l,j as n,n as e,F as o,m as c,t as d,q as t,v as p,x as u,y as r,T as v,l as g,u as m,b as y,g as h,f as k,h as b,a6 as f,p as w,a1 as C,B as $,z as x,G as z,a7 as T,J as P,a8 as S,i as U,N,O as _,P as j,Q as I}from"./index-87c9ba8f.js";import{w as L}from"./wxjssdk-bba02966.js";import{g as K}from"./sign-54d406fa.js";let E,G,J;const O=a({name:"525",components:{},setup(s,a){var i,l;const{proxy:n}=I();let e=new L({});const o=m(),c=y({version:2,k:"",imgUrl:"https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/525/image2",userInfo:(null==(i=o.params)?void 0:i.userInfo)??{},spinning:!1,volume:!1,dialogs:"",scale:h(1250),audioList:[{name:"bgm",src:"https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/525/bgm.mp3",loop:!0},{name:"open",src:"https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/525/open.mp3"}],video:!1,playing:!1,signToday:!1,signCount:0,active:[1],special:!1,basic:5e3});J=(null==(l=c.userInfo)?void 0:l.unionid)??"";const d=(s,a=!1)=>{N(c,s,a)},t=s=>{n.$Message.success(s)};return k((()=>{var s,a,i;E=(null==(s=o.meta)?void 0:s.activityKey)??"525",G=(null==(a=o.meta)?void 0:a.periodNum)??1;let l=location.origin+o.path,n=(null==(i=o.meta)?void 0:i.imgUrl)??"";b({activityKey:E,periodNum:G}).then((({code:s,data:a})=>{var i,l,n,e,o,d;0===s&&(c.k=a.k,c.active=(null==(i=null==a?void 0:a.extra)?void 0:i.active)??[],c.version=(null==(l=null==a?void 0:a.extra)?void 0:l.version)??1,c.special=(null==(n=null==a?void 0:a.extra)?void 0:n.special)??!1,c.basic=(null==(e=null==a?void 0:a.extra)?void 0:e.basic)??0,(null==(d=null==(o=null==a?void 0:a.extra)?void 0:o.whiteList)?void 0:d.includes(J))&&(c.version=2),c.spinning=!0,S({unionid:J,periodNum:5}).then((({code:s,data:a})=>{0===s&&a.playType1.forEach((s=>{(null==s?void 0:s.addTime)&&U(s.addTime)&&(c.signToday=!0)}))})).finally((()=>{c.spinning=!1})),f({activityKey:E,periodNum:G}).then((({code:s,data:a})=>{0===s&&(c.signCount=a.playCount+c.basic)})))})),e.ready((()=>{var s,a;setTimeout((()=>{d("bgm",!0)}),100),e.updateShareData({title:(null==(s=o.meta)?void 0:s.title)??"",desc:(null==(a=o.meta)?void 0:a.desc)??"",link:l,imgUrl:n}),document.addEventListener("visibilitychange",(s=>{document.hidden?w():c.volume&&d("bgm",!0)}))}))})),{...C(c),onPlayAudio:d,showMessage:t,onGetPrize:s=>{c.active.includes(s)?c.dialogs=`prize-${s}`:t("奖励暂未开始")},onSign:()=>{if(!c.spinning)if(c.signToday)t("今天已参与摇一摇");else{c.spinning=!0;let s={ownerUnionid:J,playType:1,periodNum:5,content:{}};c.playing=!0,setTimeout((()=>{c.playing=!1}),2e3),T(s).then((({code:s})=>{if(0==s){c.signToday=!0,c.signCount++,t("参与成功"),d("open");let{k:s}=c,a=K({k:s,unionid:J,score:0,level:0});P({ownerUnionid:J,activityKey:E,gameScore:0,levelNum:0,playTime:0,extra:{},k:s,s:a})}})).finally((()=>{c.spinning=!1}))}},onJump:()=>{let s="";switch(1*c.dialogs.split("-")[1]){case 2:case 4:case 6:case 9:s="/bottle2";break;case 3:case 7:s="/wish"}s&&(w(),z.push({path:s})),c.dialogs=""},onShowPrize:s=>{if([1,5,8].includes(s)){if(8===s&&!c.active.includes(s))return;c.dialogs=`show-${s}`}},onSpecial:(s,a=null)=>{a?window.open(a):(c.special?1===s?window.open(c.special):z.push({path:"/bottle2"}):t("活动暂未开放"),c.dialogs="")},onPlayVideo:()=>{c.video=!0,setTimeout((()=>{document.getElementById("video").play()}),0)}}}}),q=s=>(_("data-v-295462db"),s=s(),j(),s),A={class:"bg-main"},B=q((()=>n("span",{class:"icon-logo"},null,-1))),M=$('<span class="icon-xyy" data-v-295462db></span><span class="icon-bell" data-v-295462db></span><div class="bg-title" data-v-295462db><span class="icon-dot-1" data-v-295462db></span><span class="icon-dot-2" data-v-295462db></span><span class="icon-dot-3" data-v-295462db></span></div>',3),V={key:1,class:"top-dot"},D=[q((()=>n("span",{class:"icon-dot-1-1"},null,-1))),q((()=>n("span",{class:"icon-dot-2-1"},null,-1))),q((()=>n("span",{class:"icon-dot-3-1"},null,-1)))],F={class:"bg-task"},Q={class:"task-icon"},H={class:"task-line"},R={class:"line-content"},W=["onClick"],X={key:1,class:"line-card icon-help"},Y=["onClick"],Z={class:"bg-play"},ss={class:"play-count"},as={id:"page-dialogs"},is={key:0},ls={key:0,class:"dialogs-prize"},ns=["src"],es=["src"],os={class:"video-box"},cs={id:"video",width:"460",height:"229",controls:"",preload:"true"},ds=["src"],ts=q((()=>n("span",{class:"bg-poster"},null,-1))),ps=[q((()=>n("div",{class:"dialogs-share icon-share"},null,-1)))],us={id:"audio-list"},rs=["id","src","loop"];const vs=s(O,[["render",function(s,a,m,y,h,k){return i(),l("div",{id:"page-525",class:e(`v-${s.version}`)},[n("div",A,[n("div",{class:e(["top-main",1===s.version?"bg-top":"bg-top-2"])},[B,1===s.version?(i(),l(o,{key:0},[M],64)):(i(),l("div",V,D))],2),n("div",F,[n("div",Q,[(i(),l(o,null,c(10,(a=>n("span",{class:e([`icon-${a}`,{active:s.active.includes(a)}]),key:`task-icon-${a}`},null,2))),64))]),n("div",H,[(i(),l(o,null,c([10,9,8,7,6,5,4,3,2,1],(a=>n("div",{class:e(["line-item",[{active:s.active.includes(a)}]]),key:`task-line-${a}`},[n("span",{class:e(["line-icon",[`icon-${a}`]])},null,2),n("span",R,[n("i",{class:e(["line-word",`icon-w${a}-1`])},null,2),s.active.includes(a)||5===a||1===a?(i(),l("span",{key:0,class:e(["line-card",`icon-p${a}`]),onClick:i=>s.onShowPrize(a)},null,10,W)):(i(),l("span",X)),n("i",{class:"btn-get",onClick:i=>s.onGetPrize(a)},null,8,Y)])],2))),64))])]),n("div",{class:"btn-rule",onClick:a[0]||(a[0]=a=>s.dialogs="rule")}),n("div",Z,[n("span",{class:e(["icon-bell-play",{active:s.playing}])},null,2),n("span",ss,d(s.signCount)+"次",1),n("span",{class:e(["play-btn",s.signToday?"btn-play-2":"btn-play-1"]),onClick:a[1]||(a[1]=a=>s.onSign())},null,2),n("span",{class:"btn-share2",onClick:a[2]||(a[2]=a=>s.dialogs="share")})])]),t(n("div",as,[u(v,{name:"fade"},{default:r((()=>["rule"==s.dialogs?(i(),l("div",is,[n("div",{class:"dialogs-rule bg-rule",style:x(`transform:scale(${s.scale})`)},[n("span",{class:"dialogs-close",onClick:a[3]||(a[3]=a=>s.dialogs="")})],4)])):g("",!0)])),_:1}),u(v,{name:"fade"},{default:r((()=>[-1!==s.dialogs.indexOf("prize-")?(i(),l("div",ls,[n("div",{class:e(`bg-${s.dialogs}`)},[n("span",{class:"prize-btn",onClick:a[4]||(a[4]=a=>s.onJump())}),n("span",{class:"prize-close",onClick:a[5]||(a[5]=a=>s.dialogs="")})],2)])):g("",!0)])),_:1}),u(v,{name:"fade"},{default:r((()=>[-1!==s.dialogs.indexOf("show-")?(i(),l("div",{key:0,class:"dialogs-prize dialogs-show",style:x(`transform:scale(${s.scale})`)},[n("div",{class:e(`bg-${s.dialogs}`)},[n("span",{class:"prize-close",onClick:a[6]||(a[6]=a=>{s.dialogs="",s.video=!1})}),1!==s.version&&"show-special"===s.dialogs?(i(),l(o,{key:0},[n("span",{class:e(["btn-get-3-1",{active:s.special}]),onClick:a[7]||(a[7]=a=>s.onSpecial(1))},null,2),n("span",{class:"btn-get-2",onClick:a[8]||(a[8]=a=>s.onSpecial(2))})],64)):g("",!0),"show-special"!==s.dialogs?(i(),l(o,{key:1},["show-1"===s.dialogs?(i(),l("img",{key:0,src:`${s.imgUrl}/background/show-1-4.png`},null,8,ns)):"show-5"===s.dialogs?(i(),l("img",{key:1,src:`${s.imgUrl}/background/show-5-3.png`},null,8,es)):g("",!0),n("div",os,[n("video",cs,[n("source",{src:s.imgUrl+"/video2.mp4",type:"video/mp4"},null,8,ds)]),s.video?g("",!0):(i(),l(o,{key:0},[ts,n("span",{class:"btn-play",onClick:a[9]||(a[9]=a=>s.onPlayVideo())})],64))])],64)):g("",!0)],2)],4)):g("",!0)])),_:1}),u(v,{name:"fade"},{default:r((()=>["share"==s.dialogs?(i(),l("div",{key:0,onClick:a[10]||(a[10]=a=>s.dialogs="")},ps)):g("",!0)])),_:1})],512),[[p,s.dialogs]]),s.audioList.length?(i(),l("div",{key:0,class:e(["btn-music",{active:s.volume}]),onClick:a[11]||(a[11]=a=>s.onPlayAudio("bgm",!0))},null,2)):g("",!0),t(n("div",us,[(i(!0),l(o,null,c(s.audioList,(s=>(i(),l("audio",{id:"audio-item-"+s.name,key:"audio-item-"+s.name,src:s.src,loop:s.loop??!1},null,8,rs)))),128))],512),[[p,!1]])],2)}],["__scopeId","data-v-295462db"]]);export{vs as default};
