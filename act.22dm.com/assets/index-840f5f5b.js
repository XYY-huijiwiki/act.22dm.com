import{_ as a,o,c as s,j as e,x as n,y as l,T as t,q as i,v as d,n as c,F as r,m,d as u,u as p,Y as g,r as k,g as v,b,f as y,h as f,a3 as w,p as h,a1 as I,a2 as B,z as x,t as C,l as $,w as P,H as Y,N as _,Q as X,O as E,P as M}from"./index-cfeae59d.js";import{w as U}from"./wxjssdk-753d301d.js";import{l as L}from"./lottie-5044be2c.js";let j,A,T,V="https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/705/image";const N=u({name:"705",components:{},setup(a,o){var s,e;const{proxy:n}=X();let l=new U({});const t=p(),i=g(),d=k(v(1200)),c=b({m:!0,k:"",imgUrl:V,userInfo:(null==(s=t.params)?void 0:s.userInfo)??{},loadingPrecent:5,volume:!1,bookMusic:!1,video:!1,videoPlaying:!1,share:0,scene:"mm",dialogs:"",currBookIndex:0,list:[6,6,8,8,4,7,3,5,5],bottle:[0,0],arrow:[0,0],downloadUrl:["download.png","download.png","download.png","download.png","download.png","download.png","download.png","download.png","download.png"],status:[0],active:[],audioList:[{name:"bgm",src:`${V}/audio/bgm.mp3`,loop:!0},{name:"loading",src:`${V}/audio/loading.mp3`},{name:"start",src:`${V}/audio/start.mp3`},{name:"book-click",src:`${V}/audio/book-click.mp3`},{name:"book-open",src:`${V}/audio/book-open.mp3`},{name:"book-opened",src:`${V}/audio/book-opened.mp3`},{name:"book-music",src:`${V}/audio/book-music.mp3`},{name:"btn",src:`${V}/audio/btn.mp3`}]});T=(null==(e=c.userInfo)?void 0:e.unionid)??"";let r=null;const m=()=>{r=setInterval((()=>{if(c.loadingPrecent>=100)clearInterval(r),(()=>{const a=document.getElementById("poster-1");if(a){const o=document.getElementById("poster"),s=document.getElementById("poster-2"),e=document.getElementById("poster-3"),n=document.getElementById("poster-4"),l=[{transform:"translateX(105%) translateY(-10%)",opacity:.5},{transform:"translateX(62%) translateY(-10%)",opacity:1},{transform:"translateX(19%) translateY(-10%)",opacity:1}],t=[{transform:"translateX(105%) translateY(0%)",opacity:.5},{transform:"translateX(57%) translateY(0%)",opacity:1},{transform:"translateX(0%) translateY(0%)",opacity:1}],i=[{transform:"translateX(-105%) translateY(-20%)",opacity:.5},{transform:"translateX(-57.5%) translateY(-20%)",opacity:1},{transform:"translateX(-10%) translateY(-20%)",opacity:1}],d=[{transform:"translateX(-105%) translateY(-20%)",opacity:.5},{transform:"translateX(-57.5%) translateY(-20%)",opacity:1},{transform:"translateX(-10%) translateY(-20%)",opacity:1}],r={duration:800,iterations:1,easing:"linear",fill:"forwards"};a.animate(l,r).onfinish=async()=>{"mm"===c.scene&&(await w(100),s.animate(t,r).onfinish=async()=>{"mm"===c.scene&&(await w(100),e.animate(i,r).onfinish=async()=>{"mm"===c.scene&&(await w(100),n.animate(d,r).onfinish=async()=>{"mm"===c.scene&&(await w(100),c.status[0]=1,o.animate([{opacity:0}],{duration:300,iterations:1,easing:"linear",fill:"forwards"}))})})})}}})();else{let a=c.loadingPrecent+5;a>100&&(a=100),c.loadingPrecent=a}}),100)},u=(a,o=!1)=>{_(c,a,o)},B=a=>{n.$Message.success(a)};return y((async()=>{var a,o,s;j=(null==(a=t.meta)?void 0:a.activityKey)??"705",A=(null==(o=t.meta)?void 0:o.periodNum)??1;let e=location.origin+t.path,n=(null==(s=t.meta)?void 0:s.imgUrl)??"";f({activityKey:j,periodNum:A}).then((async({code:a,data:o})=>{var s,e,n,l,t;0===a&&(m(),c.k=o.k,c.active=(null==(s=null==o?void 0:o.extra)?void 0:s.active)??[],c.bottle=(null==(e=null==o?void 0:o.extra)?void 0:e.bottle)??[0,0],c.arrow=(null==(n=null==o?void 0:o.extra)?void 0:n.bottle)??[0,0],(null==(t=null==(l=null==o?void 0:o.extra)?void 0:l.whiteList)?void 0:t.includes(T))&&(c.active=[1,2,3,4,5,6,7,8,9],c.bottle=[1,1]),await w(500),u("loading"))})),l.ready((()=>{var a,o;setTimeout((()=>{u("bgm",!0)}),100),l.updateShareData({title:(null==(a=t.meta)?void 0:a.title)??"",desc:(null==(o=t.meta)?void 0:o.desc)??"",link:e,imgUrl:n}),document.addEventListener("visibilitychange",(a=>{document.hidden?h():c.volume&&u("bgm",!1)}))}))})),{...I(c),onPlayAudio:u,showMessage:B,onBook:a=>{c.active.includes(a+1)?(u("book-click"),c.currBookIndex=a,c.dialogs="lottie",Y((()=>{(async()=>{const a=document.getElementById("lottie"),o=L.loadAnimation({container:a,renderer:"canvas",loop:!1,autoplay:!1,path:`${V}/tutu.json`});o.addEventListener("complete",(()=>{u("book-opened"),c.dialogs="book"})),await w(300),o.play(),u("book-open")})()}))):(c.dialogs="wait",setTimeout((()=>{"wait"===c.dialogs&&(c.dialogs="")}),1500))},onJump:a=>{h(),i.push({path:`/${a}`}),c.dialogs=""},downloadImage:()=>{let{currBookIndex:a,downloadUrl:o}=c,s=`${V}/book/${a+1}/${o[a]}`;l.onSaveImage(s).then((a=>{B(a)})).catch((a=>{B(a)}))},scale:d,onBookMusic:()=>{(h(),c.bookMusic)?u("bgm",!1):(u("book-music",!c.volume),document.getElementById("audio-item-book-music").addEventListener("ended",(()=>{u("bgm",!1)})));c.bookMusic=!c.bookMusic},onBottle:a=>{c.bottle[a]?(c.arrow[a]=0,c.dialogs="bottle"):c.dialogs="wait"},onPlayVideo:()=>{c.videoPlaying=!0,setTimeout((()=>{document.getElementById("video").play()}),0)},onOpenVideoMask:()=>{7===c.currBookIndex&&(c.video=!0)}}}}),O=()=>{B((a=>({f1d0a2c0:a.scale})))},z=N.setup;N.setup=z?(a,o)=>(O(),z(a,o)):O;const J=N,K=a=>(E("data-v-4ed987a0"),a=a(),M(),a),S={key:0,id:"scene-mm",class:"scene-layer bg-mm"},q={class:"mm-main"},D=K((()=>e("span",{class:"icon-mm-title-1"},null,-1))),F={class:"icon-mm-loading"},H={class:"loading-text scene-layer"},Q=K((()=>e("span",{class:"icon-mm-title-2"},null,-1))),G=K((()=>e("span",{class:"icon-reserved"},null,-1))),R=K((()=>e("div",{id:"poster"},[e("div",{id:"poster-1",class:"poster bg-poster-1"}),e("div",{id:"poster-2",class:"poster bg-poster-2"}),e("div",{id:"poster-3",class:"poster bg-poster-3"}),e("div",{id:"poster-4",class:"poster bg-poster-4"})],-1))),W={key:0,id:"scene-game",class:"scene-layer bg-game-color"},Z={id:"game-bg",class:"scene-layer bg-game"},aa={id:"game-main"},oa=K((()=>e("span",{class:"icon-game-xi"},null,-1))),sa=K((()=>e("span",{class:"icon-game-hui"},null,-1))),ea=K((()=>e("span",{class:"icon-game-title"},null,-1))),na=K((()=>e("span",{class:"icon-game-logo"},null,-1))),la={class:"game-icon scene-layer"},ta={key:0,class:"arrow arrow-1"},ia={key:1,class:"arrow arrow-2"},da=["onClick"],ca={class:"icon-book-0"},ra={class:"icon-book-1"},ma={id:"page-dialogs"},ua={key:0,class:"dialogs-lottie"},pa=[K((()=>e("div",{id:"lottie"},null,-1)))],ga={key:0},ka={class:"dialogs-book"},va={class:"dialogs-download"},ba=["src"],ya={class:"dialogs-download-list"},fa={key:0},wa={class:"dialogs-rule bg-rule"},ha={class:"dialogs-btn-list"},Ia=[K((()=>e("div",{class:"dialogs-wait bg-wait"},null,-1)))],Ba={key:0},xa={class:"dialogs-bottle bg-bottle"},Ca={class:"dialogs-btn-list"},$a={class:"video-box"},Pa={id:"video",width:"640",height:"360",preload:"true",controls:""},Ya=["src"],_a=K((()=>e("span",{class:"bg-poster-video"},null,-1))),Xa=[K((()=>e("div",{class:"icon-share"},null,-1)))],Ea={id:"audio-list"},Ma=["id","src","loop"];const Ua=a(J,[["render",function(a,u,p,g,k,v){return o(),s(r,null,[e("div",{id:"page-705",class:c({m:a.m})},[n(t,{name:"fade"},{default:l((()=>["mm"===a.scene?(o(),s("div",S,[i(e("div",q,[D,e("span",F,[e("span",{class:"loading-bg",style:x({width:373*a.loadingPrecent/100+"px"})},null,4),e("span",H,C(a.loadingPrecent)+"% ",1)]),Q],512),[[d,!a.status[0]]]),G,R,a.status[0]?(o(),s("span",{key:0,class:"btn-start",onClick:u[0]||(u[0]=o=>{a.scene="game",a.onPlayAudio("start")})})):$("",!0)])):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>["game"===a.scene?(o(),s("div",W,[e("div",Z,[e("div",aa,[oa,sa,ea,na,e("div",la,[a.dialogs?$("",!0):(o(),s(r,{key:0},[a.arrow[0]?(o(),s("span",ta)):$("",!0),a.arrow[1]?(o(),s("span",ia)):$("",!0),e("span",{class:"btn-bottle-1",onClick:u[1]||(u[1]=o=>a.onBottle(0))}),e("span",{class:"btn-bottle-2",onClick:u[2]||(u[2]=o=>a.onBottle(1))}),e("span",{class:"btn-rule",onClick:u[3]||(u[3]=o=>a.dialogs="rule")}),e("span",{class:"btn-share",onClick:u[4]||(u[4]=o=>a.share=!0)}),a.audioList.length?(o(),s("span",{key:2,class:c(["btn-music",{active:a.volume}]),onClick:u[5]||(u[5]=o=>a.onPlayAudio("bgm",!0))},null,2)):$("",!0)],64)),(o(),s(r,null,m(9,((o,s)=>e("span",{class:c(["icon-book-mask",`book-${s+1}`]),key:"book-"+s,onClick:o=>a.onBook(s)},[i(e("span",ca,null,512),[[d,!a.active.includes(s+1)]]),i(e("span",ra,null,512),[[d,a.active.includes(s+1)]])],10,da))),64))])])])])):$("",!0)])),_:1}),i(e("div",ma,[n(t,{name:"fade"},{default:l((()=>["lottie"===a.dialogs?(o(),s("div",ua,pa)):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>[["book","download"].includes(a.dialogs)?(o(),s("div",ga,[e("div",ka,[(o(!0),s(r,null,m(a.list[a.currBookIndex],((e,n)=>(o(),s("span",{key:`book-${a.currBookIndex+1}-${n}`,class:c(["scene-layer",[`book-${a.currBookIndex+1}-${e}`]])},null,2)))),128)),i(e("div",{class:"book-main",onClick:u[9]||(u[9]=P((o=>a.onOpenVideoMask()),["self"]))},[e("span",{class:"btn-back",onClick:u[6]||(u[6]=P((o=>a.dialogs=""),["stop"]))}),e("span",{class:"btn-download",onClick:u[7]||(u[7]=P((o=>a.dialogs="download"),["stop"]))}),i(e("span",{class:c(["btn-book-music",{"btn-scale":!a.bookMusic}]),onClick:u[8]||(u[8]=o=>a.onBookMusic())},null,2),[[d,1===a.currBookIndex]])],512),[[d,"book"===a.dialogs]])])])):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>["download"===a.dialogs?(o(),s("div",{key:0,onClick:u[12]||(u[12]=P((o=>a.dialogs="book"),["self"]))},[e("div",va,[e("img",{src:`${a.imgUrl}/book/${a.currBookIndex+1}/${a.downloadUrl[a.currBookIndex]}`},null,8,ba),e("div",ya,[e("span",{class:"btn-download2",onClick:u[10]||(u[10]=P(((...o)=>a.downloadImage&&a.downloadImage(...o)),["stop"]))})]),e("span",{class:"btn-close",onClick:u[11]||(u[11]=o=>a.dialogs="book")})])])):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>["rule"==a.dialogs?(o(),s("div",fa,[e("div",wa,[e("div",ha,[e("span",{class:"btn-ok",onClick:u[13]||(u[13]=P((o=>a.dialogs=""),["stop"]))})])])])):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>["wait"==a.dialogs?(o(),s("div",{key:0,onClick:u[14]||(u[14]=o=>a.dialogs="")},Ia)):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>["bottle"==a.dialogs?(o(),s("div",Ba,[e("div",xa,[e("div",Ca,[e("span",{class:"btn-back",onClick:u[15]||(u[15]=P((o=>a.dialogs=""),["stop"]))}),e("span",{class:"btn-bottle",onClick:u[16]||(u[16]=P((o=>a.onJump("bottle2")),["stop"]))})])])])):$("",!0)])),_:1}),n(t,{name:"fade"},{default:l((()=>[a.video?(o(),s("div",{key:0,class:"dialogs-video",onClick:u[18]||(u[18]=P((o=>{a.video=!1,a.videoPlaying=!1}),["self"]))},[e("div",$a,[e("video",Pa,[e("source",{src:a.imgUrl+"/vvv.mp4",type:"video/mp4"},null,8,Ya)]),a.videoPlaying?$("",!0):(o(),s(r,{key:0},[_a,e("span",{class:"btn-video",onClick:u[17]||(u[17]=o=>a.onPlayVideo())})],64))])])):$("",!0)])),_:1})],512),[[d,a.dialogs||a.video]])],2),n(t,{name:"fade"},{default:l((()=>[a.share?(o(),s("div",{key:0,class:"dialogs-share",onClick:u[19]||(u[19]=o=>a.share=0)},Xa)):$("",!0)])),_:1}),i(e("div",Ea,[(o(!0),s(r,null,m(a.audioList,(a=>(o(),s("audio",{id:"audio-item-"+a.name,key:"audio-item-"+a.name,src:a.src,loop:a.loop??!1},null,8,Ma)))),128))],512),[[d,!1]])],64)}],["__scopeId","data-v-4ed987a0"]]);export{Ua as default};
