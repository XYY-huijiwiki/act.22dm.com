import{_ as a,o as s,c as n,j as e,k as l,l as o,T as c,y as i,z as d,F as t,v as r,d as m,u,Y as g,r as p,g as v,J as b,a as w,f,i as k,a1 as h,a2 as x,A as I,q as y,m as C,x as $,n as q,C as D,a3 as P,p as _,H as A,E as L,G as S}from"./index-d8b3cf2b.js";import{w as j}from"./wxjssdk-660da706.js";import{h as G}from"./html2canvas.esm-323b70d4.js";let Q="https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/708/image";const T=m({name:"708",components:{},setup(a,s){var n,e;const{proxy:l}=A();let o=new j({});const c=u();g();const i=p(v(1600)),d=p(v(b()?2150:2050)),t=w({m:!0,k:"",imgUrl:Q,userInfo:(null==(n=c.params)?void 0:n.userInfo)??{},loadingPrecent:0,volume:!1,share:0,downloadId:1,scene:"",dialogs:"",imgData:null,showQ:!0,currIndex:0,answer:[null,null,null,null,null],audioList:[{name:"loading",src:`${Q}/audio/loading.mp3`},{name:"bgm",src:`${Q}/audio/bgm.mp3`,loop:!0},{name:"music-a",src:`${Q}/audio/music-a.mp3`,loop:!0},{name:"music-b",src:`${Q}/audio/music-b.mp3`,loop:!0},{name:"create",src:`${Q}/audio/create.mp3`}]});null==(e=t.userInfo)||e.unionid;const r=()=>{let[a,s]=function(a){let s=0,n=0;for(let e of a)1===e?s++:2===e&&n++;return s>n?[1,s]:s<n?[2,n]:[1,s]}(t.answer),n=D(1,3);2===a&&(n+=3),t.downloadId=n,t.dialogs="create",y("create"),setTimeout((()=>{m()}),4e3)},m=()=>{let a=document.getElementById("download-img");G(a,{width:750,height:1920,useCORS:!0,allowTaint:!0,scale:1,backgroundColor:"transparent"}).then((a=>{let s=a.toDataURL("image/png");t.imgData=s,t.dialogs="download"}))};let x=null;const I=async()=>{t.loadingPrecent=0,t.scene="loading",x&&clearInterval(x),x=setInterval((()=>{if(t.loadingPrecent>=100)clearInterval(x),t.scene="mm";else{let a=t.loadingPrecent+5;a>100&&(a=100),t.loadingPrecent=a}}),120),await P(100),y("loading")},y=(a,s=!1)=>{_(t,a,s)};return f((async()=>{var a,s,n;null==(a=c.meta)||a.activityKey,null==(s=c.meta)||s.periodNum;let e=location.origin+c.path,l=(null==(n=c.meta)?void 0:n.imgUrl)??"";I(),o.ready((()=>{var a,s;setTimeout((()=>{y("bgm",!0)}),100),o.updateShareData({title:(null==(a=c.meta)?void 0:a.title)??"",desc:(null==(s=c.meta)?void 0:s.desc)??"",link:e,imgUrl:l}),document.addEventListener("visibilitychange",(a=>{document.hidden?k():t.volume&&y("bgm")}))}))})),{...h(t),onPlayAudio:y,showMessage:a=>{l.$Message.success(a)},onLoadPrecent:I,scale:i,scale2:d,onAnswer:a=>{let{currIndex:s}=t;1===s&&t.answer[s]!==a&&(k(),y(1===a?"music-a":"music-b",!t.volume)),t.answer[s]=a},onNext:()=>{let{currIndex:a,answer:s}=t;if(s[a]){if(1===a)k(),y("bgm",!1);else if(4===a)return void r();t.showQ=!1,t.currIndex++,q((()=>{t.showQ=!0}))}},onGameStart:(a=!1)=>{t.currIndex=0,t.answer=[null,null,null,null,null],t.dialogs="",t.imgData="",t.scene=a?"mm":"game"},onDownloadClose:()=>{t.dialogs="",t.imgData="",t.scene="mm"},onGameSave:m}}}),U=()=>{x((a=>({"351462df":a.scale,"6d77f933":a.scale2})))},z=T.setup;T.setup=z?(a,s)=>(U(),z(a,s)):U;const E=T,N=a=>(L("data-v-17181735"),a=a(),S(),a),M={id:"page-708"},R={key:0,id:"scene-loading",class:"scene-layer bg-loading"},B={class:"loading-center"},F=N((()=>e("span",{class:"icon-loading-center-1"},null,-1))),H=N((()=>e("span",{class:"icon-loading-center-2"},null,-1))),J=N((()=>e("span",{class:"icon-loading-center-3"},null,-1))),K={class:"icon-loading-center-4"},O={class:"icon-loading-precent"},Y=N((()=>e("i",{class:"icon-loading-text"},null,-1))),V=N((()=>e("span",{class:"icon-loading-center-xi"},null,-1))),W={key:0,id:"scene-mm",class:"scene-layer"},X=N((()=>e("div",{class:"bg-loading"},null,-1))),Z=N((()=>e("div",{class:"mm-main"},[e("div",{class:"mm-main-bg scene-layer"},[e("div",{class:"bg-mm"})]),e("span",{class:"icon-mm-bottom"}),e("span",{class:"icon-mm-top"})],-1))),aa={class:"mm-role"},sa=N((()=>e("span",{class:"icon-mm-hui"},null,-1))),na=N((()=>e("span",{class:"icon-mm-xi"},null,-1))),ea=N((()=>e("span",{class:"mm-title"},[e("span",{class:"icon-mm-title2"}),e("span",{class:"icon-mm-title"})],-1))),la={class:"mm-btn-list"},oa=N((()=>e("span",{class:"icon-logo2"},[e("span",{class:"icon-logo"})],-1))),ca={key:0,id:"scene-game",class:"scene-layer"},ia={key:0,class:"game-main scene-layer"},da={class:"scene-layer"},ta={id:"page-dialogs"},ra={class:"download-main"},ma={class:"download-box"},ua=["src"],ga=N((()=>e("span",{class:"icon-download-tips"},null,-1))),pa={key:0,class:"dialogs-create bg-loading"},va=[N((()=>e("div",{class:"create-main"},[e("span",{class:"icon-c1"}),e("span",{class:"icon-c2"}),e("span",{class:"icon-c3"}),e("span",{class:"icon-c4"}),e("span",{class:"icon-c5"}),e("span",{class:"icon-c6"})],-1))),N((()=>e("span",{class:"icon-creating"},null,-1)))],ba=[N((()=>e("div",{class:"icon-share"},null,-1)))],wa={id:"audio-list"},fa=["id","src","loop"];const ka=a(E,[["render",function(a,m,u,g,p,v){return s(),n(t,null,[e("div",M,[l(c,{name:"fade"},{default:o((()=>["loading"===a.scene?(s(),n("div",R,[e("div",B,[F,H,J,e("span",K,[e("i",O,I(a.loadingPrecent)+"%",1),Y]),V])])):y("",!0)])),_:1}),l(c,{name:"fade"},{default:o((()=>["mm"===a.scene?(s(),n("div",W,[X,Z,e("div",aa,[sa,na,ea,e("span",{class:"btn-start",onClick:m[0]||(m[0]=s=>a.onGameStart())})]),e("div",la,[e("span",{class:"btn-back",onClick:m[1]||(m[1]=s=>a.onLoadPrecent())}),e("span",{class:C(["btn-music",{active:a.volume}]),onClick:m[2]||(m[2]=s=>a.onPlayAudio("bgm",!0))},null,2),e("span",{class:"btn-share",onClick:m[3]||(m[3]=s=>a.share=1)})]),oa])):y("",!0)])),_:1}),l(c,{name:"fade"},{default:o((()=>["game"===a.scene?(s(),n("div",ca,[e("div",{class:C(["game-bg",`bg-q-${a.currIndex+1}-background`])},null,2),a.showQ?(s(),n("div",ia,[e("div",{class:C(["game-top",`bg-q-${a.currIndex+1}-top`])},[e("div",{class:C(["game-title2",`bg-q-${a.currIndex+1}-title2`])},null,2),e("div",{class:C(["game-role",`bg-q-${a.currIndex+1}-mask`])},[e("span",{class:C(["game-left",`bg-q-${a.currIndex+1}-left`])},null,2),e("span",{class:C(["game-right",`bg-q-${a.currIndex+1}-right`])},null,2)],2)],2),e("div",{class:C(["game-bottom",`bg-q-${a.currIndex+1}-bottom`])},[e("div",da,[e("div",{class:C(["game-title",`bg-q-${a.currIndex+1}-title`])},null,2),e("div",{class:C(["game-a",[`bg-q-${a.currIndex+1}-a`,{active:1===a.answer[a.currIndex]}]]),onClick:m[4]||(m[4]=s=>a.onAnswer(1))},null,2),e("div",{class:C(["game-b",[`bg-q-${a.currIndex+1}-b`,{active:2===a.answer[a.currIndex]}]]),onClick:m[5]||(m[5]=s=>a.onAnswer(2))},null,2),e("span",{class:C(["game-next",[4!==a.currIndex?"btn-next":"btn-finish",{disabled:!a.answer[a.currIndex]}]]),onClick:m[6]||(m[6]=s=>a.onNext())},null,2)])],2)])):y("",!0),e("span",{class:"btn-back",onClick:m[7]||(m[7]=s=>a.onGameStart(1))})])):y("",!0)])),_:1}),i(e("div",ta,[l(c,{name:"fade"},{default:o((()=>{var l;return["download"===a.dialogs||"create"===a.dialogs?(s(),n("div",{key:0,class:"dialogs-download",onClick:m[10]||(m[10]=$((s=>a.onDownloadClose()),["self"]))},[e("div",{id:"download-img",class:C(["download-img",`download-${a.downloadId}`])},[e("div",{class:C(["download-nickname",`nickname-${a.downloadId}`])},I((null==(l=a.userInfo)?void 0:l.nickname)??""),3)],2),e("div",ra,[e("div",ma,[a.imgData?(s(),n("img",{key:0,class:"download-img download-img-data",src:a.imgData},null,8,ua)):y("",!0)]),e("span",{class:"btn-back",onClick:m[8]||(m[8]=s=>a.onDownloadClose())}),e("span",{class:"btn-share",onClick:m[9]||(m[9]=s=>a.share=1)})]),ga])):y("",!0)]})),_:1}),l(c,{name:"fade"},{default:o((()=>["create"===a.dialogs?(s(),n("div",pa,va)):y("",!0)])),_:1})],512),[[d,a.dialogs||a.share]]),l(c,{name:"fade"},{default:o((()=>[a.share?(s(),n("div",{key:0,class:"dialogs-share",onClick:m[11]||(m[11]=s=>a.share=0)},ba)):y("",!0)])),_:1})]),i(e("div",wa,[(s(!0),n(t,null,r(a.audioList,(a=>(s(),n("audio",{id:"audio-item-"+a.name,key:"audio-item-"+a.name,src:a.src,loop:a.loop??!1},null,8,fa)))),128))],512),[[d,!1]])],64)}],["__scopeId","data-v-17181735"]]);export{ka as default};
