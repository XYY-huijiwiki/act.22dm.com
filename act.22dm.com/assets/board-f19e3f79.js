let t,e;class i{constructor(i,s){let n=i.getBoundingClientRect();e=n.top,t=n.left,this.container=i,this.config=s,this.canvas=this.createCanvas(i),this.ctx=this.canvas.getContext("2d"),this.startX=0,this.stateY=0,this.pathSegmentHistory=[],this.index=0,this.init()}createCanvas(t){const e=document.createElement("canvas");return e.width=t.clientWidth,e.height=t.clientHeight,e.style.display="block",e.style.backgroundColor=this.config.backgroundColor,e.id=this.config.canvasId,t.appendChild(e),e}init(){this.addPathSegment(),this.setContext2DStyle(this.config),this.canvas.addEventListener("contextmenu",(t=>t.preventDefault())),this.canvas.addEventListener("touchstart",this.mousedownEvent.bind(this))}setContext2DStyle(t){this.ctx.strokeStyle=t.strokeStyle??"#dbd7dc",this.ctx.lineWidth=t.lineWidth??3,this.ctx.lineCap="round",this.ctx.lineJoin="round"}mousedownEvent(i){const s=this,n=this.ctx,{brushWidth:h}=this.config;n.beginPath(),n.moveTo(i.touches[0].clientX-t,i.touches[0].clientY-e),n.stroke(),this.canvas.ontouchmove=function(i){let s=i.touches[0].clientX-t,a=i.touches[0].clientY-e;"#000000"==n.strokeStyle?n.clearRect(s-h/2,a-h/2,h,h):(n.lineTo(s,a),n.stroke())},this.canvas.ontouchend=this.canvas.ontouchleave=function(){s.addPathSegment(),this.onmousemove=null,this.onmouseup=null,this.onmouseout=null}}keydownEvent(t){if(t.ctrlKey)switch(t.keyCode){case 90:this.undo();break;case 89:this.redo()}}addPathSegment(){const t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);this.pathSegmentHistory.splice(this.index+1),this.pathSegmentHistory.push(t),this.index=this.pathSegmentHistory.length-1}undo(){this.index<=0||(this.index--,this.ctx.putImageData(this.pathSegmentHistory[this.index],0,0))}redo(){this.index>=this.pathSegmentHistory.length-1||(this.index++,this.ctx.putImageData(this.pathSegmentHistory[this.index],0,0))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}}export{i as B};
