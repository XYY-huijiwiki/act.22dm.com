import{_ as e,d as a,u as l,r as s,i as t,g as n,a as i,w as o,b as c,e as d,f as u,p,h as r,o as v,c as m,j as g,k as y,l as k,m as I,n as h,q as f,T as w,F as b,s as x,t as C,v as $,x as q,y as T,z as L,A as _,B as R,C as z,D as X,E as Y,G as E,H as j,I as N,J as K,K as M,L as U}from"./index-10e1dbb6.js";import{w as D}from"./wxjssdk-23aea717.js";import{g as G}from"./sign-54d406fa.js";import{s as Q,h as P}from"./loading-36075d31.js";const S=e=>(N("data-v-06dba38e"),e=e(),K(),e),A={key:0,id:"mm",class:"scene-layer bg-mm"},B=S((()=>g("span",{class:"icon-mm-top"},null,-1))),F=S((()=>g("span",{class:"icon-mm-bottom"},null,-1))),H={class:"mm-main"},J=S((()=>g("span",{class:"icon-mm-title"},null,-1))),W=S((()=>g("span",{class:"btn btn-rule"},null,-1))),O=S((()=>g("span",{class:"icon-reserved"},null,-1))),V={key:0,id:"game",class:"scene-layer"},Z={class:"game-bg-wrap"},ee={class:"bg-game"},ae=["onClick"],le={key:0,class:"icon-arrow"},se={key:1,class:"icon-lock"},te=S((()=>g("div",{class:"bg-game-left"},null,-1))),ne=S((()=>g("div",{class:"bg-game-right"},null,-1))),ie={class:"topbar-left"},oe={class:"game-role-img"},ce=["src"],de={class:"game-btn-list"},ue={key:0,id:"map",class:"scene-layer"},pe=["onClick"],re={class:"topbar-left"},ve=S((()=>g("span",{class:"btn-rule"},null,-1))),me={class:"topbar-left"},ge={class:"topbar-right"},ye={class:"question-content icon-q-content"},ke={class:"question-title"},Ie={class:"question-word"},he=S((()=>g("span",{class:"icon-question-tips"},null,-1))),fe=["onClick"],we={id:"page-dialogs"},be={key:0,class:"dialogs-task"},xe={class:"bg-task"},Ce={class:"task-list"},$e={class:"icon-task-1"},qe={class:"icon-task-2"},Te={class:"icon-task-3"},Le={class:"task-text"},_e={key:1,class:"icon-task-get-2"},Re={class:"icon-task-4"},ze={class:"task-text"},Xe={key:1,class:"icon-task-get-2"},Ye={class:"icon-task-5"},Ee={key:0,class:"dialogs-record"},je=S((()=>g("div",{class:"record-info"},[g("div",{class:"bg-record-info"})],-1))),Ne={class:"record-list"},Ke={key:0,class:"icon-date-get"},Me=S((()=>g("div",{class:"bg-date-2"},null,-1))),Ue=[S((()=>g("div",{class:"icon-share"},null,-1)))],De={key:0,id:"audio-list"},Ge=["id","src","loop"],Qe=e(a({name:"20260123",setup(e){var a;let N,K,S,Qe="https://cpe-oss-h5.oss-cn-shenzhen.aliyuncs.com/h5/20260123/image-v1";const{proxy:Pe}=M();let Se=new D({});const Ae=l();let Be="";const Fe=(null==(a=Ae.params)?void 0:a.userInfo)??{};S=(null==Fe?void 0:Fe.unionid)??"";const He=s(t()),Je=s(!1),We=s(n(1200)),Oe=s(n(1200)),Ve=s(n(1400)),Ze=s("mm"),ea=s(""),aa=s(!1),la=s(!1),sa=s(0),ta=s([]),na=s(!1),ia=s(null),oa=s(1),ca=s(!0),da=s(!1),ua=s(1),pa=s(0);let ra=!1;const va=i({volume:!1,audioList:[{name:"bgm",src:`${Qe}/audio/bgm.mp3`,loop:!0},{name:"click",src:`${Qe}/audio/click.mp3`,loop:!1},{name:"collect",src:`${Qe}/audio/collect.mp3`,loop:!1}]});let ma=s({gameEntry:[{id:1,width:1600,height:130,top:110,left:0,new:1},{id:2,width:300,height:130,top:440,left:0,lock:1},{id:3,width:1200,height:130,top:620,left:0,lock:1}],mapConfig:{map_1:{mapId:1,roleX:500,roleY:100,npcList:[{npcId:1,x:873,y:317,width:150,height:120,roleX:700,roleY:350,tips:1,questionId:1},{npcId:2,x:382,y:406,width:180,height:150,roleX:491,roleY:541,tips:2,questionId:4},{npcId:3,x:1150,y:420,width:180,height:180,roleX:1e3,roleY:450,tips:3,questionId:7},{npcId:4,x:873,y:317,width:150,height:120,roleX:700,roleY:350,tips:4,questionId:5},{npcId:5,x:900,y:40,width:450,height:150,roleX:1e3,roleY:150,tips:5,gameId:1,nextRoleId:6,tipsClass:"center"},{npcId:6,x:873,y:317,width:150,height:120,roleX:700,roleY:350,tips:6,questionId:6}],questionList:[{questionId:1,npcId:1,imgId:1,answerList:[{answerId:1,nextQuestionId:2,nextRoleId:1},{answerId:2,nextQuestionId:3,nextRoleId:1}]},{questionId:2,npcId:1,imgId:1,answerList:[{answerId:1,nextRoleId:3}]},{questionId:3,npcId:1,imgId:1,answerList:[{answerId:1,nextRoleId:2}]},{questionId:7,npcId:3,imgId:3,answerList:[{answerId:1,nextRoleId:4}]},{questionId:4,npcId:4,imgId:2,answerList:[{answerId:1,nextRoleId:4}]},{questionId:7,npcId:3,imgId:3,answerList:[{answerId:1,nextRoleId:4}]},{questionId:5,npcId:4,imgId:1,answerList:[{answerId:1,nextRoleId:5}]},{questionId:6,npcId:6,imgId:1,answerList:[{answerId:1,isCollect:1}]}]}}});o(sa,(e=>{oa.value=1,ia.value=null,ua.value=1,da.value=!1}));const ga=c((()=>{let e=0,a=null,l=0,s=[],t=0,n=0,i=0,o=0,c=[],d=[],u=[];ta.value.map((n=>{const{addTime:p}=n,r=U(p);if(n.extra){const{type:v=""}=n.extra;if(r&&("login"===v&&e++,"date"===v&&t++,"share"===v&&i++,"play-egg"===v&&o++,"collect"===v&&u.push(n),v.startsWith("map-"))){const{mapId:e=0,npcId:a=0}=n.extra;e&&("map-npc"===v&&(c.includes(100*e+a)||c.push(100*e+a)),"map-entry"===v&&(d.includes(e)||d.push(e)))}if("selectRole"===v&&(a=n.extra.roleId),"play"===v&&l++,"date"===v){const e=p.split(" ")[0].split("2026-")[1];e&&!s.includes(e)&&s.push(e)}}})),i&&n++,t&&n++,o&&n++,c.length>=3&&n++,d.length>=2&&n++,n=n>5?5:n;return{loginToday:e,roleId:a,playCount:l,dateList:s,dateToday:t,canPrizeToday:n,shareToday:i,playEggToday:o,mapNpcToday:c,entryMapListToday:d,collectTodayList:u}})),ya=c((()=>{let e=ma.value.mapConfig[`map_${sa.value}`],a=e.roleX,l=e.roleY,s=null;if(ia.value){let s=e.npcList.find((e=>e.npcId===ia.value));s&&(a=s.roleX,l=s.roleY)}if(ua.value){let a=e.questionList.find((e=>e.questionId===ua.value));a&&(s=a)}return{...e,roleX:a,roleY:l,question:s}})),ka=e=>{const{collectTodayList:a}=ga.value;a.filter((e=>e.extra.mapId===sa.value)).length<5?(Ca("collect"),ea.value="collect-2",ba({type:"collect",mapId:sa.value})):ea.value="collect-max"},Ia=e=>{if(Ca("click"),"close"===e)return void(sa.value=0);if("collect"===e)return ea.value="",oa.value=1,void(ia.value=null);if(na.value)return;const{questionId:a,gameId:l,prize:s}=e;let t=600;ia.value===e.npcId&&(t=0),t&&(na.value=!0,ia.value=e.npcId),setTimeout((()=>{if(a&&(ua.value=a,da.value=!0),l){const{nextRoleId:a}=e;1===l&&(oa.value=a,wa())}s&&ka(),na.value=!1,ba({type:"map-npc",mapId:sa.value,npcId:e.npcId})}),t)},ha=e=>{if(["record","prize"].includes(e))xa("活动将于1月25日开启");else{if("task"===e)return la.value=!0,void Ca("click");"date"===e&&(ga.value.dateToday||ba({type:"date"}),Ca("click")),ea.value=e,e&&Ca("click")}},fa=e=>{Je.value||(1===e?(aa.value=!0,Je.value=!0,setTimeout((()=>{Je.value=!1,ba({type:"share"})}),3e3)):2===e?ha("date"):5===e&&wa())},wa=()=>{ra=!0,z.push({path:"/20251002-v2"})},ba=(e={},a=!0)=>{const l=R(0,1e3),s=R(0,20);let t=G({k:Be,unionid:S,score:l,level:s});const n=(new Date).getTime();X({ownerUnionid:S,activityKey:N,gameScore:l,levelNum:s,playTime:n,extra:e,k:Be,s:t});const i={addTime:Y(n),extra:{...e}};return a&&ta.value.push(i),i},xa=e=>{Pe.$Message.success(e,3)},Ca=(e,a=!1)=>{j(va,e,a)};return d((async()=>{var e,a;Q("加载中...",90),N=(null==(e=Ae.meta)?void 0:e.activityKey)??"20260123",K=(null==(a=Ae.meta)?void 0:a.periodNum)??1,u({activityKey:N}).then((async({code:e,data:a})=>{0===e&&(Be=a.k,a.extra,(async()=>{Je.value=!0,E({activityKey:N,periodNum:K,ownerUnionid:S}).then((({code:e,data:a})=>{0===e&&a?(a.length&&a.sort(((e,a)=>a.id-e.id)),ta.value=a,ga.value.loginToday||ba({type:"login"})):xa("获取记录异常,请刷新后再试")})).finally((()=>{Je.value=!1,P()}))})())})),Se.ready((()=>{var e,a,l;Ca("bgm",!0),Se.updateShareData({title:(null==(e=Ae.meta)?void 0:e.title)??"",desc:(null==(a=Ae.meta)?void 0:a.desc)??"",link:location.origin+Ae.path,imgUrl:(null==(l=Ae.meta)?void 0:l.imgUrl)??""}),document.addEventListener("visibilitychange",(e=>{document.hidden?p():va.volume&&Ca("bgm",!0)}))}))})),r((()=>{ra&&(ra=!1,(null==window?void 0:window.playEggGame)&&(window.playEggGame=!1,ba({type:"play-egg"})))})),(e,a)=>(v(),m(b,null,[g("div",{id:"page-20260123",class:h({m:He.value})},[y(w,{name:"fade"},{default:k((()=>["mm"==Ze.value?(v(),m("div",A,[B,F,g("div",H,[J,g("span",{class:"btn-start",onClick:a[0]||(a[0]=I((e=>(ga.value.roleId||ba({type:"selectRole",roleId:R(1,6)}),Ze.value="game",setTimeout((()=>{ha("tips-map-1")}),300),void Ca("click"))),["stop"]))})]),W,g("span",{class:h(["btn btn-music",[{active:va.volume}]]),onClick:a[1]||(a[1]=e=>Ca("bgm",!0))},null,2),O])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>["game"==Ze.value?(v(),m("div",V,[g("div",Z,[g("div",ee,[(v(!0),m(b,null,x($(ma).gameEntry,(e=>(v(),m("div",{key:e.id,class:"game-entry",onClick:I((a=>(e=>{const{id:a=null,lock:l=0}=e;!e.lock&&a&&(sa.value=a,ca.value=!1,ba({type:"map-entry",mapId:a}),Ca("click"))})(e)),["stop"]),style:C(`width:${e.width}px;height:${e.height}px;margin-top:${e.top}px;margin-left:${e.left}px;`)},[ca.value&&e.new?(v(),m("span",le)):f("",!0),e.lock?(v(),m("span",se)):f("",!0)],12,ae)))),128))])]),te,ne,g("div",ie,[g("span",{class:h(["btn-music",[{active:va.volume}]]),onClick:a[2]||(a[2]=e=>Ca("bgm",!0))},null,2),g("span",{class:"btn-rule",onClick:a[3]||(a[3]=I((e=>ha("rule")),["stop"]))})]),g("span",oe,[ga.value.roleId?(v(),m("img",{key:0,src:`${$(Qe)}/icon/role/${ga.value.roleId}.png`},null,8,ce)):f("",!0)]),g("div",de,[g("span",{class:"btn-task",onClick:a[4]||(a[4]=I((e=>ha("task")),["stop"]))}),g("span",{class:"btn-record",onClick:a[5]||(a[5]=I((e=>ha("record")),["stop"]))}),g("span",{class:"btn-prize",onClick:a[6]||(a[6]=I((e=>ha("prize")),["stop"]))}),g("span",{class:"btn-date",onClick:a[7]||(a[7]=I((e=>ha("date")),["stop"]))})])])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>["game"==Ze.value&&sa.value>0?(v(),m("div",ue,[g("div",{class:h(["map-bg",`bg-map-${sa.value}-0`])},null,2),g("div",{class:h(["map-road",`bg-map-${sa.value}-1`]),style:C(`scale:${Oe.value}`)},[g("span",{class:h(["map-role",`role-${ga.value.roleId}`]),style:C(`left:${ya.value.roleX}px;top:${ya.value.roleY}px`)},null,6),(v(!0),m(b,null,x(ya.value.npcList,(e=>(v(),m(b,{key:`npc-${e.npcId}`},[e.tips===oa.value?(v(),m("span",{key:0,onClick:I((a=>Ia(e)),["stop"]),class:"map-npc",style:C(`left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`)},[g("span",{class:h(["icon-map-tips",`${e.tipsClass||""}`])},null,2)],12,pe)):f("",!0)],64)))),128))],6),g("div",re,[g("span",{class:h(["btn-music",[{active:va.volume}]]),onClick:a[8]||(a[8]=e=>Ca("bgm",!0))},null,2),ve]),g("div",me,[g("span",{class:h(["btn-music",[{active:va.volume}]]),onClick:a[9]||(a[9]=e=>Ca("bgm",!0))},null,2),g("span",{class:"btn-rule",onClick:a[10]||(a[10]=I((e=>ha("rule")),["stop"]))}),g("span",{class:"btn-back",onClick:a[11]||(a[11]=I((e=>Ia("close")),["stop"]))})]),g("div",ge,[g("span",{class:"btn-prize2",onClick:a[12]||(a[12]=I((e=>ha("prize")),["stop"]))}),g("span",{class:"btn-record2",onClick:a[13]||(a[13]=I((e=>ha("record")),["stop"]))})])])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>[da.value?(v(),m("div",{key:0,id:"question",class:"scene-layer",onClick:a[16]||(a[16]=I((e=>da.value=!1),["self"]))},[g("div",{class:"question-role-wrap",style:C(`scale:${Ve.value}`),onClick:a[14]||(a[14]=I((e=>da.value=!1),["self"]))},[g("div",{class:h(["question-role",`question-r-${ya.value.question.imgId}`])},null,2),g("div",ye,[g("div",ke,[g("span",{class:h(`question-t-${ya.value.question.imgId}`)},null,2)]),g("div",Ie,[g("span",{class:h(`question-q-${ya.value.question.questionId}`)},null,2),he])])],4),g("div",{class:"question-answer-wrap",onClick:a[15]||(a[15]=I((e=>da.value=!1),["self"]))},[(v(!0),m(b,null,x(ya.value.question.answerList,(e=>(v(),m("span",{class:"question-answer-item-wrap",onClick:a=>(e=>{if(Je.value)return;Je.value=!0;const{answerId:a,nextQuestionId:l,nextRoleId:s,isCollect:t}=e;ba({type:"map-answer",mapId:sa.value,npcId:ia.value,questionId:ua.value,answerId:a}),pa.value=a,Ca("click"),setTimeout((()=>{Je.value=!1,pa.value=0,s===ia.value?ua.value=l:(da.value=!1,s&&(oa.value=s),t&&ka())}),300)})(e),key:e.answerId},[g("span",{class:h(`question-a-${ua.value}-${e.answerId}-${pa.value&&pa.value===e.answerId?1:0}`)},null,2)],8,fe)))),128))])])):f("",!0)])),_:1}),q(g("div",we,[y(w,{name:"fade"},{default:k((()=>["rule"===ea.value?(v(),m("div",{key:0,class:"dialogs-rule",onClick:a[17]||(a[17]=I((e=>ha("")),["stop"]))},[g("div",{class:"bg-rule",style:C(`transform:scale(${We.value})`)},null,4)])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>[la.value?(v(),m("div",be,[g("div",xe,[g("span",{class:h(["task-num",`num-c-${ga.value.canPrizeToday}`])},null,2),g("div",Ce,[g("div",$e,[g("span",{class:"task-text",onClick:a[18]||(a[18]=I((e=>fa(1)),["stop"]))},[g("i",{class:h("icon-task-get-"+(ga.value.shareToday>=1?"2":"1"))},null,2)])]),g("div",qe,[g("span",{class:"task-text",onClick:a[19]||(a[19]=I((e=>fa(2)),["stop"]))},[g("i",{class:h("icon-task-get-"+(ga.value.dateToday>=1?"2":"1"))},null,2)])]),g("div",Te,[g("span",Le,[ga.value.mapNpcToday.length<3?(v(),m(b,{key:0},[L(_(ga.value.mapNpcToday.length)+" / 3 ",1)],64)):(v(),m("i",_e))])]),g("div",Re,[g("span",ze,[ga.value.entryMapListToday.length<2?(v(),m(b,{key:0},[L(_(ga.value.entryMapListToday.length)+" / 2 ",1)],64)):(v(),m("i",Xe))])]),g("div",Ye,[g("span",{class:"task-text",onClick:a[20]||(a[20]=I((e=>fa(5)),["stop"]))},[g("i",{class:h("icon-task-get-"+(ga.value.playEggToday>=1?"2":"1"))},null,2)])])]),g("span",{class:"dialogs-close",onClick:a[21]||(a[21]=I((e=>la.value=!1),["stop"]))})])])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>["record"===ea.value?(v(),m("div",Ee,[g("div",{class:"bg-record",style:C(`transform:scale(${We.value})`)},[je,g("div",Ne,[(v(),m(b,null,x(9,(e=>g("span",{key:`record-item-${e}`,class:"bg-record-item"}))),64))]),g("span",{class:"dialogs-close",onClick:a[22]||(a[22]=I((e=>ha("")),["stop"]))})],4)])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>["prize"===ea.value?(v(),m("div",{key:0,class:"dialogs-prize",onClick:a[23]||(a[23]=I((e=>ha("")),["stop"]))})):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>["date"===ea.value?(v(),m("div",{key:0,class:"dialogs-date",onClick:a[24]||(a[24]=I((e=>ha("")),["stop"]))},[g("div",{class:"bg-date-1",style:C(`transform:scale(${$(n)(1100)})`)},[(v(),m(b,null,x([["01-18","01-19","01-20","01-21","01-22","01-23","01-24"],["01-25","01-26","01-27","01-28","01-29","01-30","01-31"],["02-01","02-02","02-03","02-04","02-05","02-06","02-07  "]],((e,a)=>g("div",{class:h(["active-row",`row-${a+1}`])},[(v(!0),m(b,null,x(e,(e=>(v(),m("span",{key:`row-${a}-${e}`,class:h(["icon-date-active",{active:ga.value.dateList.includes(e)}])},[ga.value.dateList.includes(e)?(v(),m("i",Ke)):f("",!0)],2)))),128))],2))),64)),Me],4)])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>[ea.value.includes("tips-map")?(v(),m("div",{key:0,class:"dialogs-tips-map",onClick:a[25]||(a[25]=I((e=>ha("")),["stop"]))},[g("div",{class:h(`bg-${ea.value}`),style:C(`scale:${Oe.value}`)},null,6)])):f("",!0)])),_:1}),y(w,{name:"fade"},{default:k((()=>[ea.value.includes("collect-")?(v(),m("div",{key:0,class:"dialogs-collect",onClick:a[26]||(a[26]=I((e=>Ia("collect")),["stop"]))},[g("div",{class:h(`bg-${ea.value}`),style:C(`scale:${Oe.value}`)},null,6)])):f("",!0)])),_:1}),aa.value?(v(),m("div",{key:0,class:"dialogs-share",onClick:a[27]||(a[27]=I((e=>aa.value=!1),["stop"]))},Ue)):f("",!0)],512),[[T,ea.value||aa.value||la.value]])],2),va.audioList.length?q((v(),m("div",De,[(v(!0),m(b,null,x(va.audioList,(e=>(v(),m("audio",{id:"audio-item-"+e.name,key:"audio-item-"+e.name,src:e.src,loop:e.loop??!1},null,8,Ge)))),128))],512)),[[T,!1]]):f("",!0)],64))}}),[["__scopeId","data-v-06dba38e"]]);export{Qe as default};
