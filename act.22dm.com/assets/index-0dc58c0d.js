import{ae as a,_ as e,d as l,Z as s,o as n,c as t,x as i,y as o,T as c,q as r,v as d,j as m,n as u,l as p,F as g,m as k,w as h,Y as y,u as v,b as f,g as b,S as C,f as T,h as w,p as D,a1 as I,z as x,t as R,ac as $,I as L,ad as S,J as U,M as E,D as A,L as N,N as M,K as B,Q as _,O as j,P as G}from"./index-19ecc65e.js";import{w as K}from"./wxjssdk-9b84c5c1.js";import{h as Y}from"./html2canvas.esm-323b70d4.js";import{g as O,a as P,b as X}from"./sign-54d406fa.js";import{o as z}from"./oss-3a40a5ab.js";import{I as q,T as J}from"./index-601458be.js";import"./isObjectLike-38825d63.js";const H=[{name:"bgm",src:"https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/diy/bgm.mp3",loop:!0}],F=[[[1,2,3,4,5,6,7],[1,2,3,4]],[[1,2,3,4,5,6,7,8,9,10,11,12,13],[1,2,3,4],["#ffffff","#f09450","#c6c6c6","#ed6c9e","#ec6b76","#fef668","#3fbcef","#79c471","#8e569b"]],[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],[1,2,3,4,5,6,7,8,9,10,11,12,13],[1,2,3,4,5,6,7,8],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]],[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],[1,2,3,4,5,6,7,8,9,10,11,12,13],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]]];let Q="/h5/activity";let Z,V;const W=l({name:"diy",components:{Input:q,Textarea:J},setup(e,l){var s,n;const{proxy:t}=_();let i=new K({});y();const o=v(),c=f({imgUrl:"https://cpe-app-oss.oss-cn-shenzhen.aliyuncs.com/h5/diy/image-v2",userInfo:(null==(s=o.params)?void 0:s.userInfo)??{},spinning:!1,volume:!1,scene:"mm",selectType:1,plateType:1,dialogs:"",alert:"",tips:"",scale:b(1600),k:"",k2:"",recordList:[],rankList:[],bottleList:[],audioList:H,gameData:{maxId:1,backgroundColor:"#ffffff",cover:"1/1",list:[],oss:"",name:""},targetId:null,imgData:null,beginTime:0,shareData:null,currRecord:null,currTouch:null,loupe:!1,awardIndex:-1,showAwardBtn:!1,likeCountToday:0,history:[],form:{name:"",phone:"",address:""},rankId:[]});V=(null==(n=c.userInfo)?void 0:n.unionid)??"";const r=(a,e=!0)=>new Promise(((l,s)=>{let{currRecord:n}=c,t=n.id,{k:i}=c,o=P({k:i,unionid:V,id:t});E({ownerUnionid:V,id:t,status:a,k:i,s:o}).then((()=>{e&&(g("删除成功"),c.alert="",n.status=0),l(!0)})).catch((a=>{s(a)}))})),d=()=>{A({activityKey:Z,periodNum:1,ownerUnionid:V}).then((({code:a,data:e})=>{0===a&&(c.recordList=e)}))},m=()=>{var e;(e={unionid:V,periodNum:2},a({url:Q+"/bottle/list",method:"get",params:e})).then((({code:a,data:e})=>{c.bottleList=(null==e?void 0:e.playType2)??[]}))},u=()=>{var e;(e={unionid:V,periodNum:2},a({url:Q+"/bottle-rank/list",method:"get",params:e})).then((({code:a,data:e})=>{0===a&&(c.rankList=e,e.forEach(((a,e)=>{a.userInfo.unionid==V&&c.rankId.some((e=>e===a.bottleId))&&(c.alert="rank",c.awardIndex=e,N({unionid:V,activityKey:"bottleRank",periodNum:2}).then((({code:a,data:e})=>{e&&!e.name&&(c.showAwardBtn=!0)})))})))}))},p=(a,e=!1)=>{M(c,a,e)},g=a=>{t.$Message.success(a)};return C((()=>c.tips),(a=>{var e,l,s,n,t,r,d,m,u,p,g,k,h;if("share"==a){let a="",y="";if("finish-record"==c.alert&&(a=(null==(l=null==(e=c.currRecord)?void 0:e.extra)?void 0:l.oss)??"",y=(null==(n=null==(s=c.currRecord)?void 0:s.extra)?void 0:n.name)??""),"finish-rank"==c.alert?(a=(null==(r=null==(t=c.currRecord)?void 0:t.content)?void 0:r.oss)??"",y=(null==(m=null==(d=c.currRecord)?void 0:d.content)?void 0:m.name)??""):(a=(null==(u=c.gameData)?void 0:u.oss)??"",y=(null==(p=c.gameData)?void 0:p.name)??""),a&&y){let e=JSON.stringify({img:a,name:y}),l=location.origin+o.path+`?shareData=${encodeURIComponent(e)}`;i.updateShareData({title:(null==(g=o.meta)?void 0:g.title)??"",desc:(null==(k=o.meta)?void 0:k.desc)??"",imgUrl:(null==(h=o.meta)?void 0:h.imgUrl)??"",link:l})}}})),T((()=>{var a,e;Z=(null==(a=o.meta)?void 0:a.activityKey)??"diy";let l=location.origin+o.path,s=(null==(e=o.meta)?void 0:e.imgUrl)??"";o.query.shareData&&(c.shareData=JSON.parse(decodeURIComponent(o.query.shareData)),c.alert="finish-share"),w({activityKey:Z,periodNum:1}).then((({code:a,data:e})=>{var l;0===a&&(c.rankId=(null==(l=null==e?void 0:e.extra)?void 0:l.rankId)??[],c.k=e.k,d(),m(),w({activityKey:"bottleRank",periodNum:2}).then((({code:a,data:e})=>{0===a&&(u(),c.k2=e.k)})))})),i.ready((()=>{var a,e;p("bgm",!0),i.updateShareData({title:(null==(a=o.meta)?void 0:a.title)??"",desc:(null==(e=o.meta)?void 0:e.desc)??"",link:l,imgUrl:s}),document.addEventListener("visibilitychange",(a=>{document.hidden?D():c.volume&&p("bgm",!0)}))}))})),{...I(c),onPlayAudio:p,onGameStart:(a=null,e=null)=>{c.dialogs="",c.alert="",c.tips="",c.selectType=1,c.plateType=1,a?(c.gameData=a,e&&(c.gameData.editId=e)):c.gameData={maxId:1,backgroundColor:"#ffffff",cover:"1/1",list:[],oss:"",name:""},c.imgData=null,c.beginTime=(new Date).getTime(),c.scene="game",c.history=[]},onGameSave:()=>{if(!c.spinning)if(c.gameData.name.length>=3&&c.gameData.name.length<=15){let a=document.getElementById("game-main");a&&(c.dialogs="",c.targetId=null,Y(a,{useCORS:!0,allowTaint:!0,scale:1,backgroundColor:"transparent"}).then((a=>{let e=a.toDataURL("image/png");c.imgData=e;let l=L()+".png",s=S(e,l),n=`h5/diy/upload/${l}`;c.spinning=!0,z(s,n).then((a=>{c.gameData.oss=a;let{k:e}=c,l=O({k:e,unionid:V,score:0,level:0});U({ownerUnionid:V,activityKey:Z,gameScore:0,levelNum:0,playTime:(new Date).getTime()-c.beginTime,extra:c.gameData,k:e,s:l}).then((()=>{c.gameData.editId?(g("编辑保存成功"),c.recordList.forEach((a=>{a.id==c.gameData.editId&&(a.status=0,c.currRecord=a,r(0,!1).then((()=>{d()})))}))):(g("保存成功"),d()),c.alert="finish"})).catch((a=>{g(a)})).finally((()=>{c.spinning=!1}))})).catch((a=>{g(a),c.spinning=!1}))})))}else g("请输入3-15字的名称")},showMessage:g,elementList:F,addElement:a=>{let{selectType:e,plateType:l,gameData:s}=c;if(1==e)s.cover=`${l}/${a}`;else if(2==e&&3==l)s.backgroundColor=`${a}`;else if(s.list.length<20){let n={id:s.maxId,path:`${e}/${l}/${a}`,style:{scale:1,rotate:0,offsetX:0,offsetY:0},lock:0};s.list.push(n),s.maxId++}else g("添加的元素不能超过20个")},hasElement:a=>{let e=!1,{selectType:l,plateType:s,gameData:n}=c;return e=1==l?n.cover==`${s}/${a}`:2==l&&3==s?n.backgroundColor==a:n.list.some((e=>e.path==`${l}/${s}/${a}`)),e},getElementStyle:a=>{let e="transform:translate(-50%,-50%)";return a&&(a.scale&&(e+=` scale(${a.scale})`),a.rotate&&(e+=` rotate(${a.rotate}deg) `),e+=";",a.offsetX&&(e+=`margin-left:${a.offsetX}px;`),a.offsetY&&(e+=`margin-top:${a.offsetY}px;`)),e},onElSort:a=>{let{targetId:e,gameData:l}=c;if(e){let s=l.list.findIndex((a=>a.id===e)),n=$(l.list[s]);if(1===a){if(s+1===l.list.length)return;l.list.splice(s,1),l.list.splice(s+1,0,n)}else if(-1===a){if(0===s)return;l.list.splice(s,1),l.list.splice(s-1,0,n),c.targetId=null}}else g("请先选择物品")},downloadImage:a=>{i.onSaveImage(a).then((a=>{g(a)})).catch((a=>{g(a)}))},onAddBottlePlay:(e=!1)=>{var l;if(!c.spinning)if(c.bottleList.length<1){let s=null;s=e?{...e.extra}:{...c.gameData},c.spinning=!0,(l={ownerUnionid:V,playType:2,periodNum:2,bottleType:2,content:s},a({url:Q+"/bottle/play",method:"post",data:l})).then((()=>{g("上传成功!"),c.bottleList.push(s),c.tips=""})).catch((a=>{g(a||"上传失败,请稍后再试")})).finally((()=>{c.spinning=!1}))}else g("您剩余上传的次数为0"),c.alert="rule"},onTouchStart:(a,e,l)=>{e.lock||(c.currTouch=a.touches[0],c.touchAction=a.touches[0].target.className||"move",c.history.push($(c.gameData)))},onTouchMove:(a,e,l)=>{if(!e.lock&&c.currTouch){let s={x:a.touches[0].clientX-c.currTouch.clientX,y:a.touches[0].clientY-c.currTouch.clientY};if("move"==c.touchAction)e.style.offsetX+=s.x,e.style.offsetY+=s.y,c.currTouch=a.touches[0],c.targetId=e.id;else{let n=document.getElementById("game-el-ctrl-"+l).getBoundingClientRect(),t={x:c.currTouch.clientX,y:c.currTouch.clientY};if("btn-game-rotate"==c.touchAction){let a=Math.atan2(t.x,-t.y),l=360*(Math.atan2(t.x+s.x,-(t.y+s.y))-a)/Math.PI;t.x<n.x?e.style.rotate-=l:e.style.rotate+=l}else if("btn-game-scale"==c.touchAction){let a=s.x/n.width*2;e.style.scale+a>.3&&e.style.scale+a<1.5&&(e.style.scale+=a)}c.currTouch=a.touches[0]}}},onTouchEnd:(a,e,l)=>{e.lock||(c.currTouch=null,c.touchAction="")},onElAction:(a=null,e=0,l="")=>{var s;if("copy"==l){let e={...$(a),id:c.gameData.maxId};c.gameData.maxId++,c.gameData.list.splice(-1,0,e)}else"del"==l?c.gameData.list.splice(e,1):"lock"==l?c.targetId&&c.gameData.list.forEach((a=>{a.id===c.targetId&&(a.lock=a.lock?0:1)})):"revoke"==l&&(null==(s=c.history)?void 0:s.length)&&(c.gameData=c.history[c.history.length-1],c.history.splice(c.history.length-1,1))},onUpdateRecordStatus:r,onLoupe:()=>{let a=document.getElementById("game-main");a&&Y(a,{useCORS:!0,allowTaint:!0,scale:1,backgroundColor:"transparent"}).then((a=>{let e=a.toDataURL("image/png");c.imgData=e,c.loupe=!0}))},onRankLike:e=>{if(c.spinning||e.isLike)return;if(c.likeCountToday>=3)return void g("每人每天最多投3票");c.spinning=!0;let l=X({k:c.k2,unionid:V,bottleId:e.bottleId});var s;(s={bottleId:e.bottleId,voterUnionid:V,k:c.k2,s:l,periodNum:2},a({url:Q+"/bottle-rank/like",method:"post",data:s})).then((({code:a,data:l})=>{0===a&&(e.likeCount++,e.isLike=!0,c.likeCountToday++)})).catch((a=>{g(a)})).finally((()=>{c.spinning=!1}))},submitAward:()=>{let{name:a,phone:e,address:l}=c.form;a&&e&&l?11==e.length?B({activityKey:"bottleRank",periodNum:2,ownerUnionid:V,address:l,name:a,phone:e,extra:{}}).then((()=>{c.tips="",c.showAwardBtn=!1,g("提交成功")})):g("请填写11位手机号码"):g("请输入正确的信息")}}}}),aa=a=>(j("data-v-85747a12"),a=a(),G(),a),ea={id:"page-diy"},la={key:0,id:"scene-mm",class:"scene-layer"},sa=aa((()=>m("div",{class:"mm-background bg-mm"},null,-1))),na=aa((()=>m("div",{class:"icon-mm-title"},null,-1))),ta={class:"mm-btn"},ia={key:0,id:"scene-game",class:"scene-layer"},oa={id:"game-wrap",class:"scene-layer"},ca={id:"game-top"},ra={id:"game-main"},da={class:"game-area"},ma=["src"],ua={id:"game-cover"},pa=["src"],ga=aa((()=>m("span",{class:"icon-logo"},null,-1))),ka={class:"game-area ctrl"},ha=["id","onClick","onTouchstart","onTouchmove","onTouchend"],ya=["src"],va=aa((()=>m("span",{class:"move"},null,-1))),fa=["onClick"],ba=aa((()=>m("i",{class:"btn-game-scale"},null,-1))),Ca=aa((()=>m("i",{class:"btn-game-rotate"},null,-1))),Ta=["onClick"],wa=["onClick"],Da={id:"game-select"},Ia=["onClick"],xa={id:"game-plat"},Ra=aa((()=>m("div",{class:"plat-top"},null,-1))),$a={class:"plat-main"},La={class:"plat-type-list"},Sa=["onClick"],Ua=["src"],Ea={class:"plat-list"},Aa=["onClick"],Na=["src"],Ma=["src"],Ba=aa((()=>m("span",{class:"mask"},null,-1))),_a=aa((()=>m("span",null,[m("i",{class:"icon-lock"})],-1))),ja=aa((()=>m("div",{class:"plat-bottom"},null,-1))),Ga={id:"page-dialogs",class:"scene-layer"},Ka={class:"scene-layer"},Ya={key:0,class:"dialogs-record"},Oa={class:"record-title"},Pa=aa((()=>m("span",{class:"icon-title-record"},null,-1))),Xa={class:"record-list"},za=["onClick"],qa=["src"],Ja={key:0,class:"record-ctrl"},Ha={class:"record-time"},Fa={class:"record-name"},Qa={key:0,class:"dialogs-rank"},Za={class:"rank-title"},Va=aa((()=>m("span",{class:"icon-title-rank"},null,-1))),Wa=aa((()=>m("div",{class:"icon-rank-word"},null,-1))),ae={class:"record-list"},ee=["src"],le={class:"record-name"},se={class:"record-info"},ne=["onClick"],te=["onClick"],ie={key:0,class:"dialogs-save"},oe={class:"bg-save"},ce={key:0,class:"dialogs-name"},re={class:"bg-name"},de={class:"name-tips"},me={class:"name-count"},ue={key:0,class:"dialogs-alert"},pe={key:0,class:"alert-finish"},ge={key:0,class:"finish-name"},ke={key:1,class:"finish-name"},he={key:2,class:"finish-name"},ye={key:3,class:"finish-name"},ve={class:"finish-img"},fe=["src"],be=["src"],Ce=["src"],Te=["src"],we={key:4,class:"finish-btn"},De=aa((()=>m("span",{class:"icon-ercode"},null,-1))),Ie={class:"finish-btn-right"},xe={key:5,class:"finish-comment"},Re=aa((()=>m("span",{class:"icon-word-comment-2"},null,-1))),$e=["innerHTML"],Le={key:1,class:"alert-rule bg-rule"},Se={key:2,class:"alert-del bg-del"},Ue={key:3,class:"alert-rank bg-rank"},Ee={key:1,class:"alert-edit bg-edit"},Ae={key:2,class:"alert-upload bg-upload"},Ne={key:3,class:"alert-award bg-award"},Me={id:"audio-list"},Be=["id","src","loop"],_e=["src"];const je=e(W,[["render",function(a,e,l,y,v,f){const b=s("Input"),C=s("Textarea");return n(),t("div",ea,[i(c,{name:"fade"},{default:o((()=>["mm"==a.scene?(n(),t("div",la,[sa,m("div",{class:"icon-mm-role",style:x(`transform:scale(${a.scale-.065})`)},null,4),m("div",{class:"mm-main",style:x(`transform:scale(${a.scale-.065})`)},[na,m("div",ta,[m("span",{class:"btn-record",onClick:e[0]||(e[0]=e=>a.dialogs="record")}),m("span",{class:"btn-rank",onClick:e[1]||(e[1]=e=>a.dialogs="rank")})])],4),m("div",{class:"btn-start",onClick:e[2]||(e[2]=e=>a.onGameStart())}),m("div",{class:"btn-rule",onClick:e[3]||(e[3]=e=>a.alert="rule")})])):p("",!0)])),_:1}),i(c,{name:"fade"},{default:o((()=>["game"==a.scene?(n(),t("div",ia,[m("div",oa,[m("div",ca,[m("span",{class:"btn-game-back",onClick:e[4]||(e[4]=e=>a.gameData.list.length>3?a.dialogs="save":a.scene="mm")}),m("span",{class:"btn-game-reset",onClick:e[5]||(e[5]=e=>a.onGameStart())}),m("span",{class:"btn-zindex-up",onClick:e[6]||(e[6]=e=>a.onElSort(1))}),m("span",{class:"btn-zindex-down",onClick:e[7]||(e[7]=e=>a.onElSort(-1))}),m("span",{class:"btn-lock",onClick:e[8]||(e[8]=h((e=>a.onElAction(null,0,"lock")),["stop"]))}),m("span",{class:"btn-revoke",onClick:e[9]||(e[9]=h((e=>a.onElAction(null,0,"revoke")),["stop"]))}),m("span",{class:"btn-game-save",onClick:e[10]||(e[10]=e=>a.gameData.list.length>=3?a.recordList.length<10?(a.dialogs="name",a.targetId=null):(a.showMessage("您剩余保存/编辑的次数为0"),a.alert="rule"):a.showMessage("最少添加3个元素哦"))})]),m("div",ra,[m("div",{id:"game-background",style:x(`background:${a.gameData.backgroundColor}`)},null,4),m("div",da,[(n(!0),t(g,null,k(a.gameData.list,((e,l)=>(n(),t("img",{class:"game-el-img",key:"game-el-"+l+"-"+e.id,src:`${a.imgUrl}/game/${e.path}.png`,style:x(a.getElementStyle(e.style??null)),crossorigin:"anonymous"},null,12,ma)))),128))]),m("div",ua,[m("img",{src:`${a.imgUrl}/game/1/${a.gameData.cover}.png`,crossorigin:"anonymous"},null,8,pa),ga]),m("div",ka,[(n(!0),t(g,null,k(a.gameData.list,((e,l)=>(n(),t("span",{class:u(["game-el-ctrl",{active:a.targetId==e.id}]),key:"game-el-ctrl-"+l+"-"+e.id,style:x(a.getElementStyle(e.style??null)),id:"game-el-ctrl-"+l,onClick:l=>a.targetId=e.id,onTouchstart:s=>{a.onTouchStart(s,e,l)},onTouchmove:s=>{a.onTouchMove(s,e,l)},onTouchend:s=>{a.onTouchEnd(s,e,l)}},[m("img",{src:`${a.imgUrl}/game/${e.path}.png`},null,8,ya),va,a.targetId==e.id?(n(),t(g,{key:0},[e.lock?(n(),t("span",{key:1,class:"btn-lock",onClick:h((s=>a.onElAction(e,l,"lock")),["stop"])},null,8,wa)):(n(),t(g,{key:0},[m("i",{class:"btn-game-close",onClick:h((s=>a.onElAction(e,l,"del")),["stop"])},null,8,fa),ba,Ca,m("i",{class:"btn-game-copy",onClick:h((s=>a.onElAction(e,l,"copy")),["stop"])},null,8,Ta)],64))],64)):p("",!0)],46,ha)))),128))])]),m("span",{id:"game-look",class:"btn-look",onClick:e[11]||(e[11]=e=>a.onLoupe())}),m("div",Da,[(n(),t(g,null,k(4,(e=>m("span",{key:"select-"+e,class:u([{active:a.selectType==e}]),onClick:l=>{a.plateType=1,a.selectType=e}},[m("i",{class:u(["select-"+e])},null,2)],10,Ia))),64))])]),m("div",xa,[Ra,m("div",$a,[m("div",La,[(n(!0),t(g,null,k(a.elementList[a.selectType-1].length,((e,l)=>(n(),t("span",{key:"plat-type-"+l,class:u([{active:l==a.plateType-1}]),onClick:e=>a.plateType=l+1},[m("img",{src:`${a.imgUrl}/game/word/${a.selectType}/${l+1}.png`},null,8,Ua)],10,Sa)))),128))]),m("div",Ea,[a.selectType&&a.plateType?(n(),t(g,{key:0},[(n(!0),t(g,null,k(a.elementList[a.selectType-1][a.plateType-1],((e,l)=>(n(),t("span",{key:"plate-"+l,onClick:l=>a.addElement(e),class:u({active:a.hasElement(e)})},[1==a.selectType?(n(),t("img",{key:0,src:`${a.imgUrl}/game/${a.selectType}/shape-${a.plateType}/${e}.png`},null,8,Na)):e<100?(n(),t("img",{key:1,src:`${a.imgUrl}/game/${a.selectType}/${a.plateType}/${e}.png`,crossorigin:"anonymous"},null,8,Ma)):(n(),t("i",{key:2,style:x("background:"+e)},null,4)),Ba],10,Aa)))),128)),_a],64)):p("",!0)])]),ja])])):p("",!0)])),_:1}),r(m("div",Ga,[m("div",Ka,[i(c,{name:"fade"},{default:o((()=>["record"==a.dialogs?(n(),t("div",Ya,[m("div",Oa,[m("span",{class:"btn-game-back2",onClick:e[12]||(e[12]=e=>a.dialogs="")}),Pa,m("span",{class:"btn-create",onClick:e[13]||(e[13]=e=>a.onGameStart())})]),m("div",Xa,[(n(!0),t(g,null,k(a.recordList,((l,s)=>(n(),t(g,{key:"record-item-"+s},[1===l.status?(n(),t("span",{key:0,class:"record-item bg-record-mask",onClick:e=>a.currRecord&&a.currRecord.id==l.id?a.currRecord=null:a.currRecord=l},[m("img",{class:"record-img",src:l.extra.oss},null,8,qa),a.currRecord&&a.currRecord.id==l.id?(n(),t("span",Ja,[m("i",{class:"btn-look",onClick:e[14]||(e[14]=h((e=>a.alert="finish-record"),["stop"]))}),m("i",{class:"btn-copy",onClick:e[15]||(e[15]=h((e=>{a.onGameStart(a.currRecord.extra),a.alert=""}),["stop"]))}),m("i",{class:"btn-del",onClick:e[16]||(e[16]=h((e=>a.alert="del"),["stop"]))})])):p("",!0),m("span",Ha,R(l.addTime),1),m("span",Fa,R(l.extra.name),1)],8,za)):p("",!0)],64)))),128))])])):p("",!0)])),_:1}),i(c,{name:"fade"},{default:o((()=>["rank"==a.dialogs?(n(),t("div",Qa,[m("div",Za,[m("span",{class:"btn-game-back2",onClick:e[17]||(e[17]=e=>a.dialogs="")}),Va,m("span",{class:"btn-create",onClick:e[18]||(e[18]=e=>a.onGameStart())})]),Wa,m("div",ae,[(n(!0),t(g,null,k(a.rankList,((e,l)=>(n(),t("span",{key:"record-item-"+l,class:u(["record-item bg-record-mask rank",{active:e.isLike}])},[m("img",{class:"record-img",src:e.content.oss},null,8,ee),m("span",le,R(e.content.name),1),m("span",se,[m("span",{class:"record-like",onClick:l=>a.onRankLike(e)},[m("i",{class:u(e.isLike?"btn-like1":"btn-like0")},null,2),(n(!0),t(g,null,k(e.likeCount+"",((a,e)=>(n(),t("i",{key:"record-score"+l+"-"+e,class:u(["num-"+a,"num"])},null,2)))),128))],8,ne),e.auditInfo?(n(),t("span",{key:0,class:"btn-comment",onClick:l=>{a.currRecord=e,a.alert="finish-rank"}},null,8,te)):p("",!0)])],2)))),128))])])):p("",!0)])),_:1}),i(c,{name:"fade"},{default:o((()=>["save"==a.dialogs?(n(),t("div",ie,[m("div",oe,[m("span",{class:"save-close",onClick:e[19]||(e[19]=e=>a.dialogs="")}),m("span",{class:"save-cancel",onClick:e[20]||(e[20]=e=>{a.dialogs="",a.scene="mm"})}),m("span",{class:"save-ok",onClick:e[21]||(e[21]=e=>a.dialogs="name")})])])):p("",!0)])),_:1}),i(c,{name:"fade"},{default:o((()=>["name"==a.dialogs?(n(),t("div",ce,[m("div",re,[m("span",{class:"name-close",onClick:e[22]||(e[22]=e=>{a.dialogs="",a.gameData.name=""})}),m("span",{class:"name-ok",onClick:e[23]||(e[23]=e=>a.onGameSave())}),m("span",de,"您剩余可编辑/保存"+R(10-a.recordList.length)+"次",1),i(b,{class:"input-name",value:a.gameData.name,"onUpdate:value":e[24]||(e[24]=e=>a.gameData.name=e)},null,8,["value"]),m("span",me,R(a.gameData.name.length)+"/15",1)])])):p("",!0)])),_:1}),i(c,{name:"fade"},{default:o((()=>{var l,s,i,o,c,r,d,k;return[a.alert?(n(),t("div",ue,[-1!==a.alert.indexOf("finish")?(n(),t("div",pe,[m("div",{class:u(["finish-wrap",["finish-rank"==a.alert?"bg-finish-rank":"bg-finish"]])},["finish"==a.alert?(n(),t("div",ge,R((null==(l=a.gameData)?void 0:l.name)??""),1)):"finish-record"==a.alert?(n(),t("div",ke,R((null==(i=null==(s=a.currRecord)?void 0:s.extra)?void 0:i.name)??""),1)):"finish-share"==a.alert?(n(),t("div",he,R((null==(o=a.shareData)?void 0:o.name)??""),1)):"finish-rank"==a.alert?(n(),t("div",ye,R((null==(r=null==(c=a.currRecord)?void 0:c.content)?void 0:r.name)??""),1)):p("",!0),m("div",ve,["finish"==a.alert?(n(),t("img",{key:0,src:a.imgData},null,8,fe)):"finish-record"==a.alert?(n(),t("img",{key:1,src:a.currRecord.extra.oss},null,8,be)):"finish-share"==a.alert?(n(),t("img",{key:2,src:a.shareData.img},null,8,Ce)):"finish-rank"==a.alert?(n(),t("img",{key:3,src:a.currRecord.content.oss},null,8,Te)):p("",!0),"finish-rank"==a.alert?(n(),t("span",{key:4,class:"btn-share2",onClick:e[25]||(e[25]=e=>a.tips="share")})):p("",!0)]),"finish-rank"!=a.alert?(n(),t("div",we,[De,m("span",Ie,["finish"==a.alert?(n(),t(g,{key:0},[m("span",{class:"btn-mycard",onClick:e[26]||(e[26]=e=>{a.dialogs="record",a.alert=""})}),m("span",{class:"btn-download",onClick:e[27]||(e[27]=e=>a.downloadImage(a.gameData.oss))}),m("span",{class:"btn-share",onClick:e[28]||(e[28]=e=>a.tips="share")}),m("span",{class:"btn-upload",onClick:e[29]||(e[29]=e=>a.tips="upload")})],64)):"finish-record"==a.alert?(n(),t(g,{key:1},[m("span",{class:"btn-edit",onClick:e[30]||(e[30]=e=>a.tips="edit")}),m("span",{class:"btn-download",onClick:e[31]||(e[31]=e=>a.downloadImage(a.currRecord.extra.oss))}),m("span",{class:"btn-share",onClick:e[32]||(e[32]=e=>a.tips="share")}),m("span",{class:"btn-upload",onClick:e[33]||(e[33]=e=>a.tips="upload")})],64)):"finish-share"==a.alert?(n(),t("span",{key:2,class:"btn-start",onClick:e[34]||(e[34]=e=>a.onGameStart())})):p("",!0)])])):(n(),t("div",xe,[Re,(null==(d=a.currRecord)?void 0:d.auditInfo)?(n(),t("div",{key:0,class:u(["comment-text",{award:a.showAwardBtn}]),innerHTML:(null==(k=a.currRecord)?void 0:k.auditInfo)??""},null,10,$e)):p("",!0),a.showAwardBtn?(n(),t("span",{key:1,class:"btn-award",onClick:e[35]||(e[35]=e=>a.tips="award")})):p("",!0)])),m("span",{class:"finish-close",onClick:e[36]||(e[36]=e=>a.alert="")})],2)])):p("",!0),"rule"==a.alert?(n(),t("div",Le,[m("span",{class:"rule-close",onClick:e[37]||(e[37]=e=>a.alert="")}),m("span",{class:"rule-ok",onClick:e[38]||(e[38]=e=>a.alert="")})])):p("",!0),"del"==a.alert?(n(),t("div",Se,[m("span",{class:"del-close",onClick:e[39]||(e[39]=e=>a.alert="")}),m("span",{class:"del-ok",onClick:e[40]||(e[40]=e=>a.onUpdateRecordStatus(0))})])):p("",!0),"rank"==a.alert?(n(),t("div",Ue,[m("span",{class:"rank-close",onClick:e[41]||(e[41]=e=>a.alert="")}),m("span",{class:"rank-ok",onClick:e[42]||(e[42]=e=>(a.currRecord=a.rankList[a.awardIndex],a.alert="finish-rank"))})])):p("",!0)])):p("",!0)]})),_:1}),i(c,{name:"fade"},{default:o((()=>[a.tips?(n(),t("div",{key:0,class:"dialogs-alert",onClick:e[53]||(e[53]=e=>"share"==a.tips?a.tips="":null)},["share"==a.tips?(n(),t("div",{key:0,class:"alert-share icon-share",onClick:e[43]||(e[43]=e=>a.tips="")})):p("",!0),"edit"==a.tips?(n(),t("div",Ee,[m("span",{class:"edit-close",onClick:e[44]||(e[44]=e=>a.tips="")}),m("span",{class:"edit-ok",onClick:e[45]||(e[45]=e=>a.onGameStart(a.currRecord.extra,a.currRecord.id))})])):p("",!0),"upload"==a.tips?(n(),t("div",Ae,[m("span",{class:"upload-close",onClick:e[46]||(e[46]=e=>a.tips="")}),m("span",{class:"upload-ok",onClick:e[47]||(e[47]=e=>a.onAddBottlePlay("finish-record"==a.alert&&a.currRecord))})])):p("",!0),"award"==a.tips?(n(),t("div",Ne,[m("span",{class:"award-close",onClick:e[48]||(e[48]=e=>a.tips="")}),i(b,{class:"award-name",value:a.form.name,"onUpdate:value":e[49]||(e[49]=e=>a.form.name=e)},null,8,["value"]),i(b,{class:"award-phone",value:a.form.phone,"onUpdate:value":e[50]||(e[50]=e=>a.form.phone=e)},null,8,["value"]),i(C,{class:"award-address",value:a.form.address,"onUpdate:value":e[51]||(e[51]=e=>a.form.address=e)},null,8,["value"]),m("span",{class:"award-submit",onClick:e[52]||(e[52]=e=>a.submitAward())})])):p("",!0)])):p("",!0)])),_:1})])],512),[[d,a.dialogs||a.alert||a.tips]]),a.audioList.length?(n(),t("div",{key:0,class:u(["btn-music",{active:a.volume}]),onClick:e[54]||(e[54]=e=>a.onPlayAudio("bgm",!0))},null,2)):p("",!0),r(m("div",Me,[(n(!0),t(g,null,k(a.audioList,(a=>(n(),t("audio",{id:"audio-item-"+a.name,key:"audio-item-"+a.name,src:a.src,loop:a.loop??!1},null,8,Be)))),128))],512),[[d,!1]]),a.loupe?(n(),t("div",{key:1,class:"img-loupe",onClick:e[55]||(e[55]=h((e=>a.loupe=!1),["self"]))},[m("img",{src:a.imgData},null,8,_e)])):p("",!0)])}],["__scopeId","data-v-85747a12"]]);export{je as default};
